import{a as be,d as R,b as ve,u as ye,c as we}from"./emp-34ba5cee.js";import{q as he}from"./dept-c81d3711.js";import{u as Ve}from"./loginEmp-cb0c9dd4.js";import{d as ke,r as c,i as xe,j as W,a as p,o as s,c as f,b as e,w as a,k as n,l as O,F as U,E as G,g as w,m as j,f as g,t as Ce,e as V,n as z,p as Ue,h as ze,_ as De}from"./index-de6d9716.js";import"./request-24d06a0f.js";const $=S=>(Ue("data-v-c1adcf27"),S=S(),ze(),S),je=$(()=>V("div",null,[V("div",{id:"title"},"员工管理"),V("br"),V("br")],-1)),Se=$(()=>V("br",null,null,-1)),Ie=$(()=>V("br",null,null,-1)),Le=["src"],$e={key:0},Be={key:1},Ee={key:2},Ye={key:3},Ae={key:4},qe={key:5},Me=$(()=>V("br",null,null,-1)),Pe=["src"],Te={class:"dialog-footer"},Fe=ke({__name:"index",setup(S){const H=Ve(),J=c([{name:"班主任",value:1},{name:"讲师",value:2},{name:"学工主管",value:3},{name:"教研主管",value:4},{name:"咨询师",value:5},{name:"其他",value:6}]),Y=c([{name:"男",value:1},{name:"女",value:2}]);let i=c({begin:"",end:"",date:[],name:"",gender:""}),A=c([]),q=c();xe(()=>{k(),K(),q.value=H.getLoginEmp().token});let M=c([]);const K=async()=>{let o=await he();o.code&&(M.value=o.data)};let P=c([]);const Q=o=>{P.value=o.map(t=>t.id)},_=c({currentPage:1,pageSize:5,total:0}),X=o=>{_.value.pageSize=o,k()},Z=o=>{_.value.currentPage=o,k()},k=async()=>{const o=await be(i.value.begin,i.value.end,i.value.gender,i.value.name,_.value.currentPage,_.value.pageSize);o.code&&(A.value=o.data.rows,_.value.total=o.data.total)},ee=()=>{i.value={begin:"",end:"",date:[],name:"",gender:""},k()};W(()=>i.value.date,(o,t)=>{console.log(`newVal : ${o} ; oldVal: ${t} `),o.length>0?(console.log("-----------"),i.value.begin=o[0],i.value.end=o[1]):(console.log("=========="),i.value.begin="",i.value.end="")});let b=c(!1),v=c(80),T=c(""),u=c({username:"",password:"",name:"",gender:"",phone:"",job:"",salary:"",image:"",entryDate:"",deptId:"",exprList:[]});const F=()=>{u.value={username:"",password:"",name:"",gender:"",phone:"",job:"",salary:"",image:"",entryDate:"",deptId:"",exprList:new Array}},le=()=>{b.value=!0,T.value="新增员工",F()},ae=async o=>{F(),b.value=!0;let t=await ve(o);if(t.code){u.value=t.data;let r=u.value.exprList;r&&r.length>0&&r.forEach(d=>{d.exprDate=[d.begin,d.end]})}},te=(o,t)=>{u.value.image=o.data},ne=o=>o.type!=="image/jpeg"&&o.type!=="image/png"?(w.error("图片格式不支持!"),!1):o.size/1024/1024>10?(w.error("图片大小不能超过 10 MB!"),!1):!0,oe=()=>{u.value.exprList.push({exprDate:[],begin:"",end:"",company:"",job:""})},ue=o=>{if(u.value.exprList){const t=u.value.exprList.indexOf(o);t!=-1&&u.value.exprList.splice(t,1)}};W(u,(o,t)=>{u.value.exprList&&u.value.exprList.forEach(r=>{r.begin=r.exprDate[0],r.end=r.exprDate[1]})},{deep:!0});const D=c(),de=c({username:[{required:!0,message:"用户名为必填项",trigger:"blur"},{min:2,max:20,message:"用户名长度为2-20个字",trigger:"blur"}],name:[{required:!0,message:"姓名为必填项",trigger:"blur"},{min:2,max:10,message:"姓名长度为2-10个字",trigger:"blur"}],gender:[{required:!0,message:"性别为必填项",trigger:"change"}],phone:[{required:!0,message:"手机号为必填项",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/g,message:"请输入合法的手机号",trigger:"blur"}],salary:[{pattern:/^[1-9]\d*$/g,message:"请输入合法的数字",trigger:"blur"}]}),B=o=>{o&&o.resetFields()},re=o=>{o&&o.validate(async t=>{if(t){let r;u.value.id?r=ye(u.value):r=we(u.value);let d=await r;d.code?(w.success("操作成功"),b.value=!1,k()):w.error(d.msg)}else return!1})},se=async o=>{G.confirm("您确认删除此数据吗?","删除员工",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{let t=await R(`${o}`);t.code?(w.success("删除成功"),k()):w.error(t.msg)}).catch(()=>{w.info("取消删除")})},ie=async()=>{G.confirm("您确认删除此数据吗?","删除员工",{confirmButtonText:"确认",cancelButtonText:"取消",type:"warning"}).then(async()=>{let o=await R(P.value.join(","));o.code?(w.success("删除成功"),k()):w.error(o.msg)}).catch(()=>{w.info("取消删除")})};return(o,t)=>{const r=p("el-input"),d=p("el-form-item"),I=p("el-option"),L=p("el-select"),E=p("el-date-picker"),y=p("el-button"),N=p("el-form"),h=p("el-table-column"),pe=p("el-table"),me=p("el-pagination"),m=p("el-col"),C=p("el-row"),ce=p("Plus"),fe=p("el-icon"),ge=p("el-upload"),_e=p("el-dialog");return s(),f(U,null,[je,e(N,{inline:!0,model:n(i),class:"demo-form-inline"},{default:a(()=>[e(d,{label:"姓名"},{default:a(()=>[e(r,{modelValue:n(i).name,"onUpdate:modelValue":t[0]||(t[0]=l=>n(i).name=l),placeholder:"请输入员工姓名"},null,8,["modelValue"])]),_:1}),e(d,{label:"性别"},{default:a(()=>[e(L,{modelValue:n(i).gender,"onUpdate:modelValue":t[1]||(t[1]=l=>n(i).gender=l),placeholder:"请选择"},{default:a(()=>[(s(!0),f(U,null,j(Y.value,l=>(s(),z(I,{label:l.name,value:l.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"入职时间"},{default:a(()=>[e(E,{modelValue:n(i).date,"onUpdate:modelValue":t[2]||(t[2]=l=>n(i).date=l),type:"daterange","range-separator":" 至 ","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD"},null,8,["modelValue"])]),_:1}),e(d,null,{default:a(()=>[e(y,{type:"primary",onClick:t[3]||(t[3]=l=>k())},{default:a(()=>[g("查询")]),_:1}),e(y,{type:"info",onClick:t[4]||(t[4]=l=>ee())},{default:a(()=>[g("清空")]),_:1})]),_:1})]),_:1},8,["model"]),e(y,{type:"success",onClick:t[5]||(t[5]=l=>{le(),B(D.value)})},{default:a(()=>[g("+ 新增员工")]),_:1}),e(y,{type:"danger",onClick:t[6]||(t[6]=l=>ie())},{default:a(()=>[g("- 批量删除")]),_:1}),Se,Ie,e(pe,{data:n(A),border:"",style:{width:"100%"},fit:"",onSelectionChange:Q},{default:a(()=>[e(h,{type:"selection",width:"55"}),e(h,{prop:"name",label:"姓名",align:"center",width:"130px"}),e(h,{label:"性别",align:"center",width:"100px"},{default:a(l=>[g(Ce(l.row.gender==1?"男":"女"),1)]),_:1}),e(h,{prop:"image",label:"头像",align:"center"},{default:a(l=>[V("img",{src:l.row.image,height:"40"},null,8,Le)]),_:1}),e(h,{prop:"deptName",label:"所属部门",align:"center"}),e(h,{prop:"job",label:"职位",align:"center",width:"100px"},{default:a(l=>[l.row.job==1?(s(),f("span",$e,"班主任")):l.row.job==2?(s(),f("span",Be,"讲师")):l.row.job==3?(s(),f("span",Ee,"学工主管")):l.row.job==4?(s(),f("span",Ye,"教研主管")):l.row.job==5?(s(),f("span",Ae,"咨询师")):(s(),f("span",qe,"其他"))]),_:1}),e(h,{prop:"entryDate",label:"入职时间",align:"center",width:"130px"}),e(h,{prop:"updateTime",label:"最后修改时间",align:"center"}),e(h,{label:"操作",align:"center"},{default:a(l=>[e(y,{type:"primary",size:"small",onClick:x=>{ae(l.row.id),B(D.value)}},{default:a(()=>[g("编辑")]),_:2},1032,["onClick"]),e(y,{type:"danger",size:"small",onClick:x=>se(l.row.id)},{default:a(()=>[g("删除")]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),Me,e(me,{"current-page":_.value.currentPage,"onUpdate:currentPage":t[7]||(t[7]=l=>_.value.currentPage=l),"page-size":_.value.pageSize,"onUpdate:pageSize":t[8]||(t[8]=l=>_.value.pageSize=l),"page-sizes":[5,10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",total:_.value.total,onSizeChange:X,onCurrentChange:Z},null,8,["current-page","page-size","total"]),e(_e,{modelValue:n(b),"onUpdate:modelValue":t[19]||(t[19]=l=>O(b)?b.value=l:b=l),title:n(T)},{footer:a(()=>[V("span",Te,[e(y,{onClick:t[17]||(t[17]=l=>{O(b)?b.value=!1:b=!1,B(D.value)})},{default:a(()=>[g("取消")]),_:1}),e(y,{type:"primary",onClick:t[18]||(t[18]=l=>re(D.value))},{default:a(()=>[g("保存")]),_:1})])]),default:a(()=>[e(N,{model:n(u),ref_key:"empFormRef",ref:D,rules:de.value},{default:a(()=>[e(C,null,{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"用户名","label-width":n(v),prop:"username"},{default:a(()=>[e(r,{modelValue:n(u).username,"onUpdate:modelValue":t[9]||(t[9]=l=>n(u).username=l)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"姓名","label-width":n(v),prop:"name"},{default:a(()=>[e(r,{modelValue:n(u).name,"onUpdate:modelValue":t[10]||(t[10]=l=>n(u).name=l)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"性别","label-width":n(v),prop:"gender"},{default:a(()=>[e(L,{modelValue:n(u).gender,"onUpdate:modelValue":t[11]||(t[11]=l=>n(u).gender=l),placeholder:"请选择",style:{width:"100%"}},{default:a(()=>[(s(!0),f(U,null,j(Y.value,l=>(s(),z(I,{label:l.name,value:l.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"手机号","label-width":n(v),prop:"phone"},{default:a(()=>[e(r,{modelValue:n(u).phone,"onUpdate:modelValue":t[12]||(t[12]=l=>n(u).phone=l)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"薪资","label-width":n(v),prop:"salary"},{default:a(()=>[e(r,{modelValue:n(u).salary,"onUpdate:modelValue":t[13]||(t[13]=l=>n(u).salary=l)},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"入职日期","label-width":n(v)},{default:a(()=>[e(E,{modelValue:n(u).entryDate,"onUpdate:modelValue":t[14]||(t[14]=l=>n(u).entryDate=l),type:"date",placeholder:"请选择入职日期","value-format":"YYYY-MM-DD",style:{width:"100%"}},null,8,["modelValue"])]),_:1},8,["label-width"])]),_:1})]),_:1}),e(C,null,{default:a(()=>[e(m,{span:12},{default:a(()=>[e(d,{label:"所属部门","label-width":n(v)},{default:a(()=>[e(L,{modelValue:n(u).deptId,"onUpdate:modelValue":t[15]||(t[15]=l=>n(u).deptId=l),placeholder:"请选择",style:{width:"100%"}},{default:a(()=>[(s(!0),f(U,null,j(n(M),l=>(s(),z(I,{label:l.name,value:l.id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1}),e(m,{span:12},{default:a(()=>[e(d,{label:"职位","label-width":n(v)},{default:a(()=>[e(L,{modelValue:n(u).job,"onUpdate:modelValue":t[16]||(t[16]=l=>n(u).job=l),placeholder:"请选择",style:{width:"100%"}},{default:a(()=>[(s(!0),f(U,null,j(J.value,l=>(s(),z(I,{label:l.name,value:l.value},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1},8,["label-width"])]),_:1})]),_:1}),e(C,{gutter:10},{default:a(()=>[e(m,{span:24},{default:a(()=>[e(d,{label:"头像","label-width":"80px"},{default:a(()=>[e(ge,{class:"avatar-uploader",action:"/api/upload","show-file-list":!1,headers:{token:n(q)},"on-success":te,"before-upload":ne},{default:a(()=>[n(u).image?(s(),f("img",{key:0,src:n(u).image,class:"avatar"},null,8,Pe)):(s(),z(fe,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[e(ce)]),_:1}))]),_:1},8,["headers"])]),_:1})]),_:1})]),_:1}),e(C,{gutter:10},{default:a(()=>[e(m,{span:24},{default:a(()=>[e(d,{label:"工作经历","label-width":n(v)},{default:a(()=>[e(y,{type:"success",size:"small",onClick:oe},{default:a(()=>[g("+ 添加工作经历")]),_:1})]),_:1},8,["label-width"])]),_:1})]),_:1}),(s(!0),f(U,null,j(n(u).exprList,l=>(s(),z(C,{gutter:5},{default:a(()=>[e(m,{span:10},{default:a(()=>[e(d,{label:"时间",size:"small","label-width":n(v)},{default:a(()=>[e(E,{modelValue:l.exprDate,"onUpdate:modelValue":x=>l.exprDate=x,type:"daterange","range-separator":"至","start-placeholder":"开始时间","end-placeholder":"结束时间","value-format":"YYYY-MM-DD"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label-width"])]),_:2},1024),e(m,{span:6},{default:a(()=>[e(d,{label:"公司",size:"small"},{default:a(()=>[e(r,{modelValue:l.company,"onUpdate:modelValue":x=>l.company=x,placeholder:"公司名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(m,{span:6},{default:a(()=>[e(d,{label:"职位",size:"small"},{default:a(()=>[e(r,{modelValue:l.job,"onUpdate:modelValue":x=>l.job=x,placeholder:"职位名称"},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1024),e(m,{span:2},{default:a(()=>[e(d,{size:"small"},{default:a(()=>[e(y,{type:"danger",onClick:x=>ue(l)},{default:a(()=>[g("- 删除")]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])],64)}}});const He=De(Fe,[["__scopeId","data-v-c1adcf27"]]);export{He as default};
